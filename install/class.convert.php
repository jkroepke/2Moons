<?phpclass convert{	function __construct($From, $prefix)	{			$this->olddb	= new DB_MySQLi();		$this->prefix	= $prefix;		switch($From)		{			case 'xgp':				$this->ConvertFromXGP();			break;		}	}		function ConvertFromXGP()	{		global $db;				//auto_increment				$OLDTABLES	= $this->olddb->query("SHOW TABLE STATUS WHERE Name like '".$this->prefix."%';");		while($TABLE = $this->olddb->fetch_array($OLDTABLES))		{			$TABLEINFO[$TABLE['Name']]	= $TABLE['Auto_increment'];		}		$this->olddb->free_result($OLDTABLES);				//AKS - Table				$db->query("TRUNCATE TABLE ".AKS.";");		$OLDACS	= $this->olddb->query("SELECT * FROM ".$this->prefix."aks;");		while($ACS	= $this->olddb->fetch_array($OLDACS))		{			$db->query("INSERT INTO ".AKS." (`id`, `name`, `teilnehmer`, `flotten`, `ankunft`, `galaxy`, `system`, `planet`, `planet_type`, `eingeladen`) VALUES ('".$ACS['id']."', '".$ACS['name']."', '".$ACS['teilnehmer']."', '".$ACS['flotten']."', '".$ACS['ankunft']."', '".$ACS['galaxy']."', '".$ACS['system']."', '".$ACS['planet']."', '".$ACS['planet_type']."', '".$ACS['eingeladen']."');");		}		$this->olddb->free_result($OLDACS);		$db->query("ALTER TABLE ".AKS." AUTO_INCREMENT = ".$TABLEINFO[$this->prefix.'aks'].";");						//Alliance - Table				$db->query("TRUNCATE TABLE ".ALLIANCE.";");		$OLDALLIANCE	= $this->olddb->query("SELECT * FROM ".$this->prefix."alliance;");		while($ALLIANCE = $this->olddb->fetch_array($OLDALLIANCE))		{			$db->query("INSERT INTO ".ALLIANCE." (`id`, `ally_name`, `ally_tag`, `ally_owner`, `ally_register_time`, `ally_description`, `ally_web`, `ally_text`, `ally_image`, `ally_request`, `ally_request_waiting`, `ally_request_notallow`, `ally_owner_range`, `ally_ranks`, `ally_members`, `ally_stats`, `ally_diplo`) VALUES ('".$ALLIANCE['id']."', '".$ALLIANCE['ally_name']."', '".$ALLIANCE['ally_tag']."', '".$ALLIANCE['ally_owner']."', '".$ALLIANCE['ally_register_time']."', '".$ALLIANCE['ally_description']."', '".$ALLIANCE['ally_web']."', '".$ALLIANCE['ally_text']."', '".$ALLIANCE['ally_image']."', '".$ALLIANCE['ally_request']."', '".$ALLIANCE['ally_request_waiting']."', '".$ALLIANCE['ally_request_notallow']."', '".$ALLIANCE['ally_owner_range']."', ".$ALLIANCE['ally_ranks'].", '".$ALLIANCE['ally_member']."', '1', '1');");		}		$this->olddb->free_result($OLDALLIANCE);		$db->query("ALTER TABLE ".ALLIANCE." AUTO_INCREMENT = ".$TABLEINFO[$this->prefix.'alliance'].";");						//Banned - Table				$db->query("TRUNCATE TABLE ".BANNED.";");		$OLDBANNED	= $this->olddb->query("SELECT * FROM ".$this->prefix."banned;");		while($BANNED = $this->olddb->fetch_array($OLDBANNED))		{			$db->query("INSERT INTO ".BANNED." (`id`, `who`, `theme`, `who2`, `time`, `longer`, `author`, `email`) VALUES ('".$BANNED['id']."', '".$BANNED['who']."', '".$BANNED['theme']."', '".$BANNED['who2']."', '".$BANNED['time']."', '".$BANNED['longer']."', '".$BANNED['author']."', '".$BANNED['email']."');");		}		$this->olddb->free_result($OLDBANNED);		$db->query("ALTER TABLE ".BANNED." AUTO_INCREMENT = ".$TABLEINFO[$this->prefix.'banned'].";");				//Buddy - Table				$db->query("TRUNCATE TABLE ".BUDDY.";");		$OLDBUDDY	= $this->olddb->query("SELECT * FROM ".$this->prefix."buddy;");		while($BUDDY = $this->olddb->fetch_array($OLDBUDDY))		{			$db->query("INSERT INTO ".BUDDY." (`id`, `sender`, `owner`, `active`, `text`) VALUES ('".$BUDDY['id']."', '".$BUDDY['sender']."', '".$BUDDY['owner']."', '".$BUDDY['active']."', '".$BUDDY['text']."');");		}		$this->olddb->free_result($OLDBUDDY);		$db->query("ALTER TABLE ".BUDDY." AUTO_INCREMENT = ".$TABLEINFO[$this->prefix.'buddy'].";");		//Config - Table				$OLDCONF	= $this->olddb->query("SELECT * FROM ".$this->prefix."config;");		while($CONF	= $this->olddb->fetch_array($OLDCONF))		{			$db->query("UPDATE ".CONFIG." SET `config_value` =  '".$CONF['config_value']."' WHERE `config_name` = '".$CONF['config_name']."';");		}			$this->olddb->free_result($OLDCONF);						//Fleets - Table				$db->query("TRUNCATE TABLE ".FLEETS.";");		$OLDFLEETS	= $this->olddb->query("SELECT * FROM ".$this->prefix."fleets;");		while($FLEETS = $this->olddb->fetch_array($OLDFLEETS))		{			$db->query("INSERT INTO ".FLEETS." (`fleet_id`, `fleet_owner`, `fleet_mission`, `fleet_amount`, `fleet_array`, `fleet_start_time`, `fleet_start_galaxy`, `fleet_start_system`, `fleet_start_planet`, `fleet_start_type`, `fleet_end_time`, `fleet_end_stay`, `fleet_end_galaxy`, `fleet_end_system`, `fleet_end_planet`, `fleet_end_type`, `fleet_target_obj`, `fleet_resource_metal`, `fleet_resource_crystal`, `fleet_resource_deuterium`, `fleet_resource_darkmatter`, `fleet_target_owner`, `fleet_group`, `fleet_mess`, `start_time`, `fleet_busy`) VALUES ('".$FLEETS['fleet_id']."', '".$FLEETS['fleet_owner']."', '".$FLEETS['fleet_mission']."', '".$FLEETS['fleet_amount']."', '".$FLEETS['fleet_array']."', '".$FLEETS['fleet_start_time']."', '".$FLEETS['fleet_start_galaxy']."', '".$FLEETS['fleet_start_system']."', '".$FLEETS['fleet_start_planet']."', '".$FLEETS['fleet_start_type']."', '".$FLEETS['fleet_end_time']."', '".$FLEETS['fleet_end_stay']."', '".$FLEETS['fleet_end_galaxy']."', '".$FLEETS['fleet_end_system']."', '".$FLEETS['fleet_end_planet']."', '".$FLEETS['fleet_end_type']."', '".$FLEETS['fleet_target_obj']."', '".$FLEETS['fleet_resource_metal']."', '".$FLEETS['fleet_resource_crystal']."', '".$FLEETS['fleet_resource_deuterium']."', '".$FLEETS['fleet_resource_darkmatter']."', '".$FLEETS['fleet_target_owner']."', '".$FLEETS['fleet_group']."', '".$FLEETS['fleet_mess']."', '".$FLEETS['start_time']."', '0');");		}		$this->olddb->free_result($OLDFLEETS);		$db->query("ALTER TABLE ".FLEETS." AUTO_INCREMENT = ".$TABLEINFO[$this->prefix.'fleets'].";");						//Messages - Table				$db->query("TRUNCATE TABLE ".MESSAGES.";");		$OLDMESSAGES	= $this->olddb->query("SELECT * FROM ".$this->prefix."messages;");		while($MESSAGES = $this->olddb->fetch_array($OLDMESSAGES))		{			$db->query("INSERT INTO ".MESSAGES." (`message_id`, `message_owner`, `message_sender`, `message_time`, `message_type`, `message_from`, `message_subject`, `message_text`, `message_unread`) VALUES ('".$MESSAGES['message_id']."', '".$MESSAGES['message_owner']."','".$MESSAGES['message_sender']."', '".$MESSAGES['message_time']."', '".$MESSAGES['message_type']."', '".$MESSAGES['message_from']."', '".$this->olddb->sql_escape($MESSAGES['message_subject'])."', '".$this->olddb->sql_escape($MESSAGES['message_text'])."', '0');");		}		$this->olddb->free_result($OLDMESSAGES);		$db->query("ALTER TABLE ".MESSAGES." AUTO_INCREMENT = ".$TABLEINFO[$this->prefix.'messages'].";");						//Notes - Table				$db->query("TRUNCATE TABLE ".NOTES.";");		$OLDNOTES	= $this->olddb->query("SELECT * FROM ".$this->prefix."notes;");		while($NOTES = $this->olddb->fetch_array($OLDNOTES))		{			$db->query("INSERT INTO ".NOTES." (`id`, `owner`, `time`, `priority`, `title`, `text`) VALUES ('".$NOTES['id']."', '".$NOTES['owner']."', '".$NOTES['time']."', '".$NOTES['priority']."', '".$this->olddb->sql_escape($NOTES['title'])."', '".$this->olddb->sql_escape($NOTES['text'])."');");		}		$this->olddb->free_result($OLDNOTES);		$db->query("ALTER TABLE ".NOTES." AUTO_INCREMENT = ".$TABLEINFO[$this->prefix.'notes'].";");						//Planets - Table				$db->query("TRUNCATE TABLE ".PLANETS.";");		$OLDPLANETS	= $this->olddb->query("SELECT p.*, g.id_luna, g.metal as der_metal, g.crystal as der_crystal FROM ".$this->prefix."planets as p, ".$this->prefix."galaxy as g WHERE p.id = g.id_planet;");		while($PLANETS = $this->olddb->fetch_array($OLDPLANETS))		{			$db->query("INSERT INTO ".PLANETS." (`id`, `name`, `id_owner`, `id_level`, `galaxy`, `system`, `planet`, `last_update`, `planet_type`, `destruyed`, `b_building`, `b_building_id`, `b_hangar`, `b_hangar_id`, `b_hangar_plus`, `image`, `diameter`, `points`, `ranks`, `field_current`, `field_max`, `temp_min`, `temp_max`, `metal`, `metal_perhour`, `metal_max`, `crystal`, `crystal_perhour`, `crystal_max`, `deuterium`, `deuterium_used`, `deuterium_perhour`, `deuterium_max`, `energy_used`, `energy_max`, `metal_mine`, `crystal_mine`, `deuterium_sintetizer`, `solar_plant`, `fusion_plant`, `robot_factory`, `nano_factory`, `hangar`, `metal_store`, `crystal_store`, `deuterium_store`, `laboratory`, `terraformer`, `university`, `ally_deposit`, `silo`, `small_ship_cargo`, `big_ship_cargo`, `light_hunter`, `heavy_hunter`, `crusher`, `battle_ship`, `colonizer`, `recycler`, `spy_sonde`, `bomber_ship`, `solar_satelit`, `destructor`, `dearth_star`, `battleship`, `supernova`, `bahamut`, `starcatcher`, `ifrit`, `shiva`, `catoblepas`, `oxion`, `odin`, `orbital_station`, `misil_launcher`, `small_laser`, `big_laser`, `gauss_canyon`, `ionic_canyon`, `buster_canyon`, `small_protection_shield`, `planet_protector`, `big_protection_shield`, `graviton_canyon`, `interceptor_misil`, `interplanetary_misil`, `metal_mine_porcent`, `crystal_mine_porcent`, `deuterium_sintetizer_porcent`, `solar_plant_porcent`, `fusion_plant_porcent`, `solar_satelit_porcent`, `mondbasis`, `phalanx`, `sprungtor`, `last_jump_time`, `lune_noir`, `ev_transporter`, `star_crasher`, `giga_recykler`, `dm_ship`, `der_metal`, `der_crystal`, `thriller`, `id_luna`) VALUES ('".$PLANETS['id']."', '".$this->olddb->sql_escape($PLANETS['name'])."', '".$PLANETS['id_owner']."', '".$PLANETS['id_level']."', '".$PLANETS['galaxy']."', '".$PLANETS['system']."', '".$PLANETS['planet']."', '".$PLANETS['last_update']."', '".$PLANETS['planet_type']."', '".$PLANETS['destruyed']."', '".$PLANETS['b_building']."', '".$PLANETS['b_building_id']."', '".$PLANETS['b_hanger']."', '".$PLANETS['b_hanger_id']."', '".$PLANETS['b_hanger_plus']."', '".$PLANETS['image']."', '".$PLANETS['diameter']."', '".$PLANETS['points']."', '".$PLANETS['ranks']."', '".$PLANETS['field_current']."', '".$PLANETS['field_max']."', '".$PLANETS['temp_min']."', '".$PLANETS['temp_max']."', '".$PLANETS['metal']."', '".$PLANETS['metal_perhour']."', '".$PLANETS['metal_max']."', '".$PLANETS['crystal']."', '".$PLANETS['crystal_perhour']."', '".$PLANETS['crystal_max']."', '".$PLANETS['deuterium']."', '0', '".$PLANETS['deuterium_perhour']."', '".$PLANETS['deuterium_max']."', '".$PLANETS['enery_used']."', '".$PLANETS['enery_max']."', '".$PLANETS['metal_mine']."', '".$PLANETS['crystal_mine']."', '".$PLANETS['deuterium_sintetizer']."', '".$PLANETS['solar_plant']."', '".$PLANETS['fusion_plant']."', '".$PLANETS['robot_factory']."', '".$PLANETS['nano_factory']."', '".$PLANETS['hangar']."', '".$PLANETS['metal_store']."', '".$PLANETS['crystal_store']."', '".$PLANETS['laboratory']."', '".$PLANETS['terraformer']."', '0', '".$PLANETS['ally_deposit']."', '".$PLANETS['silo']."', '".$PLANETS['small_ship_cargo']."', '".$PLANETS['big_ship_cargo']."', '".$PLANETS['light_hunter']."', '".$PLANETS['heavy_hunter']."', '".$PLANETS['crusher']."', '".$PLANETS['battle_ship']."', '".$PLANETS['colonizer']."', '".$PLANETS['recycler']."', '".$PLANETS['recycler']."', '".$PLANETS['spy_sonde']."', '".$PLANETS['bomber_ship']."', '".$PLANETS['solar_satelit']."', '".$PLANETS['destructor']."', '".$PLANETS['destructor']."', '".$PLANETS['dearth_star']."', '".$PLANETS['supernova']."', '0', '0', '0', '0', '0', '0', '0', '0', '".$PLANETS['misil_launcher']."', '".$PLANETS['small_laser']."', '".$PLANETS['big_laser']."', '".$PLANETS['gauss_canyon']."', '".$PLANETS['ionic_canyon']."', '".$PLANETS['buster_canyon']."', '".$PLANETS['small_protection_shield']."', '".$PLANETS['planet_protector']."', '0', '0', '".$PLANETS['interceptor_misil']."', '".$PLANETS['interplanetary_misil']."', '".$PLANETS['metal_mine_porcent']."', '".$PLANETS['crystal_mine_porcent']."', '".$PLANETS['deuterium_sintetizer_porcent']."', '".$PLANETS['solar_plant_porcent']."', '".$PLANETS['fusion_plant_porcent']."', '".$PLANETS['solar_satelit_porcent']."', '".$PLANETS['mondbasis']."', '".$PLANETS['phalanx']."', '".$PLANETS['phalanx']."', '".$PLANETS['sprungtor']."', '".$PLANETS['last_jump_time']."', '0', '0', '0', '0', '".$PLANETS['der_metal']."', '".$PLANETS['der_crystal']."', '0', '".$PLANETS['id_luna']."');");		}		$this->olddb->free_result($OLDPLANETS);		$db->query("ALTER TABLE ".PLANETS." AUTO_INCREMENT = ".$TABLEINFO[$this->prefix.'planets'].";");						//RW - Table				$db->query("TRUNCATE TABLE ".RW.";");		$OLDRW	= $this->olddb->query("SELECT * FROM ".$this->prefix."rw;");		while($RW = $this->olddb->fetch_array($OLDRW))		{			file_put_contents(ROOT_PATH.'raports/raport_'.$RW['rid'].'.php', '<?php'."\n".'$raport = '.$RW['raport'].';'."\n".'?>');			$db->query("INSERT INTO ".RW." (`owners`, `rid`, `raport`, `time`) VALUES ('".$RW['owners']."', '".$RW['rid']."', '', '".$RW['time']."');");		}		$this->olddb->free_result($OLDRW);						//Users - Table				$db->query("TRUNCATE TABLE ".USERS.";");		$OLDUSERS	= $this->olddb->query("SELECT u.*, p.b_tech, p.b_tech_id FROM ".$this->prefix."users as u LEFT JOIN ".$this->prefix."planets as p ON u.b_tech_planet = p.id;");		while($USERS = $this->olddb->fetch_array($OLDUSERS))		{			$db->query("INSERT INTO ".USERS." (`id`, `username`, `password`, `email`, `email_2`, `lang`, `authlevel`, `id_planet`, `galaxy`, `system`, `planet`, `current_planet`, `user_lastip`, `ip_at_reg`, `user_agent`, `current_page`, `register_time`, `onlinetime`, `dpath`, `design`, `noipcheck`, `planet_sort`, `planet_sort_order`, `spio_anz`, `settings_tooltiptime`, `settings_fleetactions`, `settings_planetmenu`, `settings_esp`, `settings_wri`, `settings_bud`, `settings_mis`, `settings_rep`, `settings_tnstor`, `urlaubs_modus`, `urlaubs_until`, `db_deaktjava`, `new_message`, `fleet_shortcut`, `b_tech_planet`, `b_tech`, `b_tech_id`, `spy_tech`, `computer_tech`, `military_tech`, `defence_tech`, `shield_tech`, `energy_tech`, `hyperspace_tech`, `combustion_tech`, `impulse_motor_tech`, `hyperspace_motor_tech`, `laser_tech`, `ionic_tech`, `buster_tech`, `intergalactic_tech`, `expedition_tech`, `metal_proc_tech`, `crystal_proc_tech`, `deuterium_proc_tech`, `graviton_tech`, `ally_id`, `ally_name`, `ally_request`, `ally_request_text`, `ally_register_time`, `ally_rank_id`, `current_luna`, `rpg_geologue`, `rpg_amiral`, `rpg_ingenieur`, `rpg_technocrate`, `rpg_espion`, `rpg_constructeur`, `rpg_scientifique`, `rpg_commandant`, `rpg_stockeur`, `darkmatter`, `rpg_defenseur`, `rpg_destructeur`, `rpg_general`, `rpg_bunker`, `rpg_raideur`, `rpg_empereur`, `bana`, `banaday`, `hof`, `wons`, `loos`, `draws`, `kbmetal`, `kbcrystal`, `lostunits`, `desunits`, `uctime`, `dm_attack`, `dm_defensive`, `dm_buildtime`, `dm_researchtime`, `dm_resource`, `dm_energie`, `dm_fleettime`, `fb_id`) VALUES ('".$USERS['id']."', '".$this->olddb->sql_escape($USERS['username'])."', '".$USERS['password']."', '".$this->olddb->sql_escape($USERS['email'])."', '".$this->olddb->sql_escape($USERS['email_2'])."', 'deutsch', '".$USERS['authlevel']."', '".$USERS['id_planet']."', '".$USERS['galaxy']."', '".$USERS['system']."', '".$USERS['planet']."', '".$USERS['current_planet']."', '".$USERS['user_lastip']."', '".$USERS['ip_at_reg']."', '".$this->olddb->sql_escape($USERS['user_agent'])."', '".$this->olddb->sql_escape($USERS['current_page'])."', '".$USERS['register_time']."', '".$USERS['onlinetime']."', 'styles/skins/darkness/', '".$USERS['design']."', '".$USERS['noipcheck']."', '".$USERS['planet_sort']."', '".$USERS['planet_sort_order']."', '".$USERS['spio_anz']."', '".$USERS['settings_tooltiptime']."', '".$USERS['settings_fleetactions']."', '1', '".$USERS['settings_esp']."', '".$USERS['settings_wri']."', '".$USERS['settings_bud']."', '".$USERS['settings_mis']."', '".$USERS['settings_rep']."', '1', '".$USERS['urlaubs_modus']."', '".$USERS['urlaubs_until']."', '".$USERS['db_deaktjava']."', '".$USERS['new_message']."', '".$this->olddb->sql_escape($USERS['fleet_shortcut'])."', '".$USERS['b_tech_planet']."', '".$USERS['b_tech']."', '".$USERS['b_tech_id']."', '".$USERS['spy_tech']."', '".$USERS['computer_tech']."', '".$USERS['military_tech']."', '".$USERS['defence_tech']."', '".$USERS['shield_tech']."', '".$USERS['energy_tech']."', '".$USERS['hyperspace_tech']."', '".$USERS['combustion_tech']."', '".$USERS['impulse_motor_tech']."', '".$USERS['hyperspace_motor_tech']."', '".$USERS['laser_tech']."', '".$USERS['ionic_tech']."', '".$USERS['buster_tech']."', '".$USERS['intergalactic_tech']."', '".$USERS['expedition_tech']."', '0', '0', '0', '".$USERS['graviton_tech']."', '".$USERS['ally_id']."', '".$USERS['ally_name']."', '".$USERS['ally_request']."', '".$USERS['ally_request_text']."', '".$USERS['ally_register_time']."', '".$USERS['ally_rank_id']."', '".$USERS['current_luna']."', '".$USERS['rpg_geologue']."', '".$USERS['rpg_amiral']."', '".$USERS['rpg_ingenieur']."', '".$USERS['rpg_technocrate']."', '".$USERS['rpg_espion']."', '".$USERS['rpg_constructeur']."', '".$USERS['rpg_scientifique']."', '".$USERS['rpg_commandant']."', '".$USERS['rpg_stockeur']."', '".$USERS['darkmatter']."', '".$USERS['rpg_defenseur']."', '".$USERS['rpg_destructeur']."', '".$USERS['rpg_general']."', '".$USERS['rpg_bunker']."', '".$USERS['rpg_raideur']."', '".$USERS['rpg_empereur']."', '".$USERS['bana']."', '".$USERS['banaday']."', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0');");		}		$this->olddb->free_result($OLDUSERS);		$db->query("ALTER TABLE ".USERS." AUTO_INCREMENT = ".$TABLEINFO[$this->prefix.'users'].";");	}}